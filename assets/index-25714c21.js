(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(n){if(n.ep)return;n.ep=!0;const a=s(n);fetch(n.href,a)}})();const L=document.getElementById("file-image"),y=document.getElementById("file-audio"),E=document.getElementById("picture"),u=document.getElementById("audio"),A=document.getElementById("brightness"),B=document.getElementById("brightness-value"),S=document.getElementById("blur"),p=document.getElementById("blur-value"),w=document.getElementById("scale"),C=document.getElementById("scale-value"),I=document.getElementById("rotate"),R=document.getElementById("rotate-value"),N=document.getElementById("hue"),T=32,_=new Uint8Array(T);let g=null,m=null,v=null;function $(){g||(g=new(window.AudioContext||window.webkitAudioContext)),m||(m=g.createAnalyser()),v||(v=g.createMediaElementSource(u)),v.connect(m),m.connect(g.destination)}function F(e){m.getByteFrequencyData(_),e(_)}y.onchange=()=>{const e=new FileReader;e.onload=t=>{u.src=t.target.result},e.readAsDataURL(y.files[0]),$()};function h({freqArray:e=[0],sliceParams:t=[0,0]}){const[s,o]=t,n=e.slice(s,o),a=n.length;return{bassAmplitude:n.reduce((r,d)=>r+d,0),arrayLength:a}}const c={brightness:50,blur:0,scale:10,rotate:5,hueRotate:0,previousBassAverage:0,brightnessCache:new Map,blurCache:new Map,scaleCache:new Map,rotateCache:new Map,useMemoization(e=new Map,t=0,s=0,o=0){const n=`${t}_${s}_${o}`;return e.has(n)?e.get(n):"not_found"},setBrightness(e){this.brightness=e},calculateBrightness(e,t){const s=e/t;let o=400;this.brightness<100&&(o=100+this.brightness/100*300);let n=100+s/255*(o-100);s<this.previousBassAverage&&(n=100+s/255*50),this.previousBassAverage=s;const a=this.brightness<1?100:n,i=`${e}_${t}_${this.brightness}`;return this.brightnessCache.set(i,a),a},getBrightness(e){const{bassAmplitude:t,arrayLength:s}=h({freqArray:e,sliceParams:[0,20]}),o=this.useMemoization(this.brightnessCache,t,s,this.brightness);return o==="not_found"?this.calculateBrightness(t,s):o},setBlur(e){this.blur=e},calculateBlur(e,t){const o=e/t/255*this.blur,n=`${e}_${t}_${this.blur}`;return this.blurCache.set(n,o),o},getBlur(e){const{bassAmplitude:t,arrayLength:s}=h({freqArray:e,sliceParams:[0,20]}),o=this.useMemoization(this.blurCache,t,s,this.blur);return o==="not_found"?this.calculateBlur(t,s):o},setScale(e){this.scale=e},calculateScale(e,t){const o=e/t/255,n=2,a=1,i=(n-a)*(this.scale/20)*o*(e>2600?2:1);let r=a+i;r<1&&(r=1);const d=`${e}_${t}_${this.scale}`;return this.scaleCache.set(d,r),r},getScale(e){const{bassAmplitude:t,arrayLength:s}=h({freqArray:e,sliceParams:[0,16]}),o=this.useMemoization(this.scaleCache,t,s,this.scale);return o==="not_found"?this.calculateScale(t,s):o},setRotate(e){this.rotate=e},calculateRotate(e,t){const o=e/t/255,n=180,a=-180,i=(this.rotate-50)/50;let r=o*i*n;r=Math.min(n,Math.max(a,r)),r=Math.floor(r);const d=`${e}_${t}_${this.rotate}`;return this.rotateCache.set(d,r),r},getRotate(e){const{bassAmplitude:t,arrayLength:s}=h({freqArray:e,sliceParams:[0,8]}),o=this.useMemoization(this.rotateCache,t,s,this.rotate);return o==="not_found"?this.calculateRotate(t,s):o},getHueRotate(e){const{bassAmplitude:t,arrayLength:s}=h({freqArray:e,sliceParams:[0,12]});return t/s/255*360}};L.onchange=()=>{const e=new FileReader;e.onload=t=>{E.src=t.target.result},e.readAsDataURL(L.files[0]),document.querySelector(".picture-show").classList.remove("picture-show-cover")};const l=(e,t)=>{e.firstChild.nodeValue=t};function q(){const e=A.value,t=S.value,s=w.value,o=I.value,n=-(o-(o-(50-o)));c.setBrightness(e),c.setBlur(t),c.setScale(s),c.setRotate(o),l(B,e),l(p,t),l(C,s),l(R,n)}function O(){A.oninput=e=>{const{value:t}=e.target;c.setBrightness(t),l(B,t)},S.oninput=e=>{const{value:t}=e.target;c.setBlur(t),l(p,t)},w.oninput=e=>{const{value:t}=e.target;c.setScale(t),l(C,t)},I.oninput=e=>{const{value:t}=e.target,s=-(t-(t-(50-t)));c.setRotate(t),l(R,s)}}O();q();let f=null,M=!1;N.onclick=e=>{M=e.target.checked};function H(){F(e=>{const t=`
      brightness(${c.getBrightness(e)}%)
      blur(${c.getBlur(e)}px)
      hue-rotate(${M?c.getHueRotate(e):0}deg)
    `,s=`
      scale(${c.getScale(e)})
      rotate(${c.getRotate(e)}deg)
    `;E.style.filter=t,E.style.transform=s})}const b=e=>{e==="start"?(document.querySelector(".author-one").classList.add("author-one-active"),document.querySelector(".author-one-active").classList.remove("author-one"),document.querySelector(".author-two").classList.add("author-two-active"),document.querySelector(".author-two-active").classList.remove("author-two")):e==="stop"&&(document.querySelector(".author-one-active").classList.add("author-one"),document.querySelector(".author-one").classList.remove("author-one-active"),document.querySelector(".author-two-active").classList.add("author-two"),document.querySelector(".author-two").classList.remove("author-two-active"))};u.onplay=()=>{if(!Boolean(E.src&&u.src))Swal.fire("Error","You must select an image and audio file to continue","error"),u.pause();else{b("start");const t=()=>{H(),f=window.requestAnimationFrame(t)};t()}};u.onpause=()=>{window.cancelAnimationFrame(f),b("stop")};u.onended=()=>{window.cancelAnimationFrame(f),b("stop")};u.onchange=()=>{window.cancelAnimationFrame(f),b("stop")};
